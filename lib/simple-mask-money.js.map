{"version":3,"file":"simple-mask-money.js","sources":["../src/args.js","../src/core.js","../src/implanter.js","../src/index.js"],"sourcesContent":["module.exports = class Args {\r\n  constructor(args) {\r\n    this.afterFormat         = () => {}; \r\n    this.allowNegative       = false;  \r\n    this.beforeFormat        = () => {};  \r\n    this.negativeSignAfter   = false;\r\n    this.decimalSeparator    = ',';\r\n    this.fixed               = true;\r\n    this.fractionDigits      = 2;\r\n    this.prefix              = '';\r\n    this.suffix              = '';\r\n    this.thousandsSeparator  = '.';\r\n    this.cursor              = 'move';\r\n\r\n    this.merge(args);\r\n  }\r\n\r\n  merge(args) {\r\n    if (!args || typeof args !== 'object') return;\r\n\r\n    this.afterFormat  = typeof args.afterFormat  === 'function' ? args.afterFormat  : this.afterFormat;\r\n    this.beforeFormat = typeof args.beforeFormat === 'function' ? args.beforeFormat : this.beforeFormat;\r\n\r\n    this.fixed             = typeof args.fixed             === 'boolean' ? args.fixed             : this.fixed;\r\n    this.allowNegative     = typeof args.allowNegative     === 'boolean' ? args.allowNegative     : this.allowNegative;    \r\n    this.negativeSignAfter = typeof args.negativeSignAfter === 'boolean' ? args.negativeSignAfter : this.negativeSignAfter;\r\n\r\n    this.decimalSeparator   = typeof args.decimalSeparator   === 'undefined' ? this.decimalSeparator   : args.decimalSeparator;\r\n    this.fractionDigits     = typeof args.fractionDigits     === 'undefined' ? this.fractionDigits     : args.fractionDigits;\r\n    this.prefix             = typeof args.prefix             === 'undefined' ? this.prefix             : args.prefix;\r\n    this.suffix             = typeof args.suffix             === 'undefined' ? this.suffix             : args.suffix;\r\n    this.thousandsSeparator = typeof args.thousandsSeparator === 'undefined' ? this.thousandsSeparator : args.thousandsSeparator;\r\n    this.cursor             = typeof args.cursor             === 'undefined' ? this.cursor             : args.cursor;\r\n  }\r\n};\r\n","const Args = require('./args');\r\nmodule.exports = class Core {\r\n  constructor(args) {\r\n    this.args = new Args(args);\r\n  }\r\n\r\n  addCompleter(value, completer, length, start = true) {\r\n    while (value.length < length) {\r\n      value = start ? `${completer}${value}` : `${value}${completer}`;\r\n    }\r\n\r\n    return value;\r\n  }\r\n\r\n  addPrefix(value) {\r\n    return `${this.args.prefix}${value}`;\r\n  }\r\n\r\n  addSeparators(value) {\r\n    let size = value.length - this.args.fractionDigits;\r\n    let character = this.args.fixed ? 'd' : 'w';\r\n    let regexp = `\\\\,?||\\\\.?(\\\\${character})`;\r\n    let hundreds = Math.ceil(size / 3);\r\n\r\n    let replacement = `${this.args.decimalSeparator}$${hundreds + 1}`;\r\n\r\n    for (let i = hundreds; i !== 0; i--) {\r\n      if (size >= 3) {\r\n        regexp = `(\\\\${character}{3})${regexp}`;\r\n        size -= 3;\r\n      } else {\r\n        regexp = `(\\\\${character}{${size}})${regexp}`;\r\n      }\r\n\r\n      if (i > 1) {\r\n        replacement = `${this.args.thousandsSeparator}$${i}${replacement}`;\r\n      } else {\r\n        replacement = `$${i}${replacement}`;\r\n      }\r\n    }\r\n\r\n    return value.replace(new RegExp(regexp), replacement);\r\n  }\r\n\r\n  addSuffix(value) {\r\n    return `${value}${this.args.suffix}`;\r\n  }\r\n\r\n  adjustDotPosition(value) {\r\n    let fractionDigits;\r\n    let retorno = value.toString();\r\n\r\n    retorno = retorno.replace('.', '');\r\n    fractionDigits = retorno.length - this.args.fractionDigits;\r\n    retorno = `${retorno.substring(0, fractionDigits)}.${retorno.substring(fractionDigits)}`;\r\n\r\n    return retorno;\r\n  }\r\n\r\n  completer(size = 1) {\r\n    return this.args.fixed ? ''.padEnd(size, '0') : ''.padEnd(size, '_');\r\n  }\r\n\r\n  checkNumberStart(value) {\r\n    const retorno = value.toString();\r\n    return retorno[0] === '.' ? `${this.args.fixed ? '0' : '_'}${retorno}` : retorno;\r\n  }\r\n\r\n  checkSuffix(value) {\r\n    let retorno;\r\n    const lastIndex = value.length - 1;\r\n    const lastButOneIndex = lastIndex - 1;\r\n    const currentLastSuffix = value.substring(lastIndex - this.args.suffix.length + 1, lastIndex + this.args.suffix.length);\r\n    const currentLastButOneSuffix = value.substring(lastButOneIndex - this.args.suffix.length + 1, lastButOneIndex + this.args.suffix.length);\r\n\r\n    switch (this.args.suffix) {\r\n      case currentLastSuffix:\r\n        retorno = value;\r\n        break;\r\n      case currentLastButOneSuffix:\r\n        var start = value.substring(0, lastButOneIndex);\r\n        retorno = `${start}${value.substring(value.length + this.args.suffix.length + 1, lastButOneIndex + this.args.suffix.length)}.`;\r\n        break;\r\n      default:\r\n        retorno = `${value.substring(0, lastIndex)}.`;\r\n        break;\r\n    }\r\n\r\n    return retorno;\r\n  }\r\n\r\n  emptyOrInvalid() {\r\n    return `${this.completer()}${this.args.decimalSeparator}${this.completer(this.args.fractionDigits)}`;\r\n  }\r\n\r\n  isFloat(number) {\r\n    return number % 1 !== 0;\r\n  }\r\n\r\n  mask(value) {\r\n    const negative = this.args.allowNegative && value.indexOf('-') !== -1;\r\n    let retorno = this.writingToNumber(value) || this.emptyOrInvalid();\r\n    retorno = this.replaceSeparator(retorno.toString(), this.args.decimalSeparator, '.');\r\n\r\n    if (!isNaN(retorno)) {\r\n      retorno = this.replaceSeparator(retorno, '.');\r\n      retorno = this.addCompleter(retorno || '', this.completer(), this.args.fractionDigits);\r\n      retorno = this.args.fractionDigits >= retorno.length ? `${this.completer()}${retorno}` : retorno;\r\n      retorno = this.addSeparators(retorno);\r\n    }\r\n\r\n    if (this.args.prefix) {\r\n      retorno = this.addPrefix(retorno);\r\n    }\r\n    if (this.args.suffix) {\r\n      retorno = this.addSuffix(retorno);\r\n    }\r\n\r\n    return `${!this.args.negativeSignAfter && negative ? '-' : ''}${retorno}${this.args.negativeSignAfter && negative ? '-' : ''}`;\r\n  }\r\n\r\n  numberToText(value) {\r\n    let retorno = this.emptyOrInvalid();\r\n    value = this.replaceSeparator(value.toString(), this.args.decimalSeparator, '.');\r\n\r\n    if (!isNaN(parseFloat(value))) {\r\n      if (this.isFloat(value)) {\r\n        const number = value.split('.');\r\n        let hundreds = number[0];\r\n        let decimals = number[1];\r\n\r\n        decimals = this.addCompleter(decimals || '', this.completer(), this.args.fractionDigits, false);\r\n\r\n        retorno = `${hundreds}${decimals}`;\r\n      } else {\r\n        retorno = this.replaceSeparator(value, '.');\r\n        retorno = this.addCompleter(retorno || '', this.completer(), this.args.fractionDigits);\r\n        retorno = this.args.fractionDigits >= retorno.length ? `${this.completer()}${retorno}` : retorno;\r\n      }\r\n\r\n      retorno = this.addSeparators(retorno);\r\n    }\r\n\r\n    if (this.args.prefix) {\r\n      retorno = this.addPrefix(retorno);\r\n    }\r\n    if (this.args.suffix) {\r\n      retorno = this.addSuffix(retorno);\r\n    }\r\n\r\n    return retorno;\r\n  }\r\n\r\n  onlyNumber(value) {\r\n    const hasDecimalSeparator = value.toString().indexOf(this.args.decimalSeparator);\r\n    let putDecimalSeparator = false;\r\n    let retorno = '';\r\n\r\n    for (let i = value.length - 1; i >= 0; i--) {\r\n      if (isFinite(value[i]) || (!this.args.fixed && value[i] === '_')) {\r\n        retorno = value[i] + retorno;\r\n      } else if (hasDecimalSeparator !== -1 && !putDecimalSeparator && value[i] === this.args.decimalSeparator) {\r\n        retorno = value[i].replace(this.args.decimalSeparator, '.') + retorno;\r\n        putDecimalSeparator = true;\r\n      }\r\n    }\r\n\r\n\r\n    return retorno[0] === '.' ? `0${retorno}` : retorno;\r\n  }\r\n\r\n  removeCompleter(value, completer, start = true) {\r\n    const getPosition = () => start ? 0 : value.length - 1;\r\n    let position = getPosition();\r\n\r\n    while (value[position] === completer) {\r\n      value = value.substring(0, position - 1) + value.substring(position + 1, value.length);\r\n      position = getPosition();\r\n    }\r\n\r\n    return value;\r\n  }\r\n\r\n  removePrefix(value) {\r\n    const position = value.indexOf(this.args.prefix, 0);\r\n\r\n    if (position !== -1) {\r\n      value = value.substring(this.args.prefix.length, value.length);\r\n    }\r\n\r\n    return value;\r\n  }\r\n\r\n  removeSuffix(value) {\r\n    const position = value.indexOf(this.args.suffix, value.length - this.args.suffix.length);\r\n\r\n    if (position !== -1) {\r\n      const start = value.substring(0, position);\r\n      value = start + value.substring(start.length + this.args.suffix.length - 1, value.length - 1);\r\n    }\r\n\r\n    return value;\r\n  }\r\n\r\n  replaceSeparator(value, separator, replacer = '') {\r\n    return value.replace(new RegExp(`\\\\${separator}`, 'g'), replacer);\r\n  }\r\n\r\n  textToNumber(value) {\r\n    let retorno = value.toString();\r\n    let completer = this.completer();\r\n\r\n    if (this.args.prefix) {\r\n      retorno = this.removePrefix(retorno);\r\n    }\r\n\r\n    if (this.args.suffix) {\r\n      retorno = this.removeSuffix(retorno);\r\n    }\r\n\r\n    retorno = this.onlyNumber(retorno);\r\n\r\n    if (retorno) {\r\n      retorno = this.removeCompleter(retorno, completer);\r\n      retorno = this.checkNumberStart(retorno);\r\n    }\r\n\r\n    return retorno || (this.args.fixed ? '0' : '');\r\n  }\r\n\r\n  writingToNumber(value) {\r\n    let retorno = value.toString();\r\n    let completer = this.completer();\r\n\r\n    if (this.args.prefix) {\r\n      retorno = this.removePrefix(retorno);\r\n    }\r\n\r\n    if (this.args.suffix) {\r\n      retorno = this.checkSuffix(retorno);\r\n      retorno = this.removeSuffix(retorno);\r\n    }\r\n\r\n    retorno = this.onlyNumber(retorno);\r\n\r\n    if (retorno) {\r\n      retorno = this.adjustDotPosition(retorno);\r\n\r\n      retorno = this.removeCompleter(retorno, completer);\r\n\r\n      retorno = this.checkNumberStart(retorno);\r\n    }\r\n\r\n    return retorno || (this.args.fixed ? '0' : '');\r\n  }\r\n};\r\n","module.exports = {\r\n  getCaretPosition(input) {\r\n    let position = -1;\r\n    if ('selectionStart' in input) {\r\n      position = input.selectionStart;\r\n    } else if (document.selection) {\r\n      input.focus();\r\n      const range = document.selection.createRange();\r\n      const length = document.selection.createRange().text.length;\r\n      range.moveStart('character', -input.value.length);\r\n      position = range.text.length - length;\r\n    }\r\n    return position;\r\n  },\r\n\r\n  setCaretPosition(input, index) {\r\n    if (input.setSelectionRange) {\r\n      input.focus();\r\n      input.setSelectionRange(index, index);\r\n    } else if (input.createTextRange) {\r\n      const range = input.createTextRange();\r\n      range.collapse(true);\r\n      range.moveEnd('character', index);\r\n      range.moveStart('character', index);\r\n      range.select();\r\n    }\r\n  },\r\n\r\n  indexMove(newValue, oldValue, index) {\r\n    switch (true) {\r\n      case oldValue.length < newValue.length:\r\n        return index + 1;\r\n      case oldValue.length > newValue.length:\r\n        return index - 1;\r\n      default:\r\n        return index;\r\n    }\r\n  },\r\n\r\n  addPropertyMask(input, core) {\r\n    input.maskArgs = {};\r\n\r\n    for (const k in core.args) {\r\n      Object.defineProperty(input.maskArgs, k, {\r\n        get() {\r\n          core.args[k];\r\n        },\r\n        set(value) {\r\n          core.args[k] = value;\r\n          input.dispatchEvent(new Event('input'));\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  addMask(input, core) {\r\n    input.addEventListener('input', e => {\r\n      const oldValue = input.value;\r\n      const newValue = core.mask(oldValue);\r\n      const oldCaretPosition = this.getCaretPosition(input);\r\n      let newCaretPosition = this.indexMove(newValue, oldValue, oldCaretPosition);\r\n\r\n      if (input.maskArgs.cursor === 'start') {\r\n        newCaretPosition = 0;\r\n      } else if (input.maskArgs.cursor === 'end') {\r\n        newCaretPosition = newValue.length;\r\n      }\r\n\r\n      input.value = newValue;\r\n      input._value = newValue;\r\n\r\n      this.setCaretPosition(input, newCaretPosition);\r\n      !(e instanceof Event) && this.refreshMask(input);\r\n    });\r\n  },\r\n\r\n  refreshMask(input) {\r\n    input.dispatchEvent(new Event('input'));\r\n  }\r\n};\r\n","const Args = require('./args');\r\nconst Core = require('./core');\r\nconst implanter = require('./implanter');\r\n\r\nlet _args = new Args();\r\n\r\nmodule.exports = class SimpleMaskMoney {\r\n  static get args() {\r\n    return _args;\r\n  }\r\n\r\n  static set args(value) {\r\n    _args = new Args(value);\r\n  }\r\n\r\n  static format(value, args) {\r\n    const core = new Core(typeof args !== 'undefined' && typeof args === 'object' ? args : _args);\r\n\r\n    const negative = core.args.allowNegative && value.indexOf('-') !== -1;  \r\n    const formatation = core.numberToText(core.textToNumber(value));\r\n    \r\n    return `${!core.args.negativeSignAfter && negative ? '-': ''}${formatation}${core.args.negativeSignAfter && negative ? '-': ''}`;\r\n  }\r\n\r\n  static formatToNumber(input, args) {\r\n    const core = new Core(typeof args !== 'undefined' && typeof args === 'object' ? args : _args);\r\n    let value = input.toString(); \r\n    let retorno = '0';\r\n\r\n    const negative = core.args.allowNegative && value.indexOf('-') !== -1;   \r\n    \r\n    if (negative) {\r\n      value = value.replace('-', '');\r\n    }\r\n\r\n    value = core.textToNumber(value);\r\n    \r\n    if (!this.args.fixed) {\r\n      value = value.replace(new RegExp('_', 'g'), '');\r\n    }\r\n\r\n    if (!isNaN(value)) {\r\n      retorno = value;\r\n    }\r\n      \r\n    return parseFloat(negative ? retorno * -1 : retorno);\r\n  }\r\n\r\n  static setMask(element, args) {\r\n    if (typeof document === 'undefined') throw 'This function only works on client side';\r\n\r\n    const input = typeof element == 'string' ? document.querySelector(element) : element;    \r\n    const core = new Core(typeof args !== 'undefined' && typeof args === 'object' ? args : _args);\r\n    \r\n    implanter.addPropertyMask(input, core);\r\n    implanter.addMask(input, core);\r\n    implanter.refreshMask(input);\r\n\r\n    input.formatToNumber = () => SimpleMaskMoney.formatToNumber(input.value, input.maskArgs);\r\n\r\n    return input;\r\n  }\r\n};\r\n"],"names":["module","args","afterFormat","allowNegative","beforeFormat","negativeSignAfter","decimalSeparator","fixed","fractionDigits","prefix","suffix","thousandsSeparator","cursor","merge","Args","value","completer","length","start","size","character","regexp","hundreds","Math","ceil","replacement","i","replace","RegExp","retorno","toString","substring","padEnd","lastIndex","lastButOneIndex","currentLastSuffix","currentLastButOneSuffix","number","negative","indexOf","writingToNumber","emptyOrInvalid","replaceSeparator","isNaN","addCompleter","addSeparators","addPrefix","addSuffix","parseFloat","isFloat","split","decimals","hasDecimalSeparator","putDecimalSeparator","isFinite","getPosition","position","separator","replacer","removePrefix","removeSuffix","onlyNumber","removeCompleter","checkNumberStart","checkSuffix","adjustDotPosition","input","selectionStart","document","selection","focus","range","createRange","text","moveStart","index","setSelectionRange","createTextRange","collapse","moveEnd","select","newValue","oldValue","core","maskArgs","k","defineProperty","dispatchEvent","Event","addEventListener","mask","oldCaretPosition","getCaretPosition","newCaretPosition","indexMove","_value","setCaretPosition","e","refreshMask","_args","Core","formatation","numberToText","textToNumber","element","querySelector","addPropertyMask","addMask","formatToNumber","SimpleMaskMoney"],"mappings":"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"}