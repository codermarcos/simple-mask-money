{"version":3,"file":"simple-mask-money.js","sources":["../src/args.js","../src/core.js","../src/implanter.js","../src/index.js"],"sourcesContent":["module.exports = class Args {\r\n  constructor(args) {\r\n    this.allowNegative       = false;    \r\n    this.negativeSignAfter   = false;\r\n    this.decimalSeparator    = ',';\r\n    this.fixed               = true;\r\n    this.fractionDigits      = 2;\r\n    this.prefix              = '';\r\n    this.suffix              = '';\r\n    this.thousandsSeparator  = '.';\r\n    this.cursor              = 'move';\r\n\r\n    this.merge(args);\r\n  }\r\n\r\n  merge(args) {\r\n    if (!args || typeof args !== 'object') return;\r\n\r\n    this.fixed               = typeof args.fixed             === 'boolean' ? args.fixed             : this.fixed;\r\n    this.allowNegative       = typeof args.allowNegative     === 'boolean' ? args.allowNegative     : this.allowNegative;    \r\n    this.negativeSignAfter   = typeof args.negativeSignAfter === 'boolean' ? args.negativeSignAfter : this.negativeSignAfter;\r\n\r\n    this.decimalSeparator    = typeof args.decimalSeparator   === 'undefined' ? this.decimalSeparator   : args.decimalSeparator;\r\n    this.fractionDigits      = typeof args.fractionDigits     === 'undefined' ? this.fractionDigits     : args.fractionDigits;\r\n    this.prefix              = typeof args.prefix             === 'undefined' ? this.prefix             : args.prefix;\r\n    this.suffix              = typeof args.suffix             === 'undefined' ? this.suffix             : args.suffix;\r\n    this.thousandsSeparator  = typeof args.thousandsSeparator === 'undefined' ? this.thousandsSeparator : args.thousandsSeparator;\r\n    this.cursor              = typeof args.cursor             === 'undefined' ? this.cursor             : args.cursor;\r\n  }\r\n};\r\n","const Args = require('./args');\r\nmodule.exports = class Core {\r\n  constructor(args) {\r\n    this.args = new Args(args);\r\n  }\r\n\r\n  isFloat(number) {\r\n    return number % 1 !== 0;\r\n  }\r\n\r\n  completer(size = 1) {\r\n    return this.args.fixed ? ''.padEnd(size, '0') : ''.padEnd(size, '_');\r\n  }\r\n\r\n  emptyOrInvalid() {\r\n    return `${this.completer()}${this.args.decimalSeparator}${this.completer(this.args.fractionDigits)}`;\r\n  }\r\n\r\n  onlyNumber(value) {\r\n    let hasDecimalSeparator = false;\r\n    let retorno = '';\r\n\r\n    for (let i = 0; i < value.length; i++) {\r\n      if (isFinite(value[i])) retorno += value[i];\r\n      if (!hasDecimalSeparator && value[i] === this.args.decimalSeparator) {\r\n        retorno += value[i].replace(this.args.decimalSeparator, '.');\r\n        hasDecimalSeparator = true;\r\n      }\r\n    }\r\n\r\n    return retorno;\r\n  }\r\n\r\n  addingPrefix(value) {\r\n    return `${this.args.prefix}${value}`;\r\n  }\r\n\r\n  removingPrefix(value) {\r\n    const position = value.indexOf(this.args.prefix, 0);\r\n\r\n    if (position !== -1) {\r\n      value = value.substring(this.args.prefix.length, value.length);\r\n    }\r\n\r\n    return value;\r\n  }\r\n\r\n  addingSuffix(value) {\r\n    return `${value}${this.args.suffix}`;\r\n  }\r\n\r\n  removingSuffix(value) {\r\n    const position = value.indexOf(this.args.suffix, value.length - this.args.suffix.length);\r\n\r\n    if (position !== -1) {\r\n      const start = value.substring(0, position);\r\n      value = start + value.substring(start.length + this.args.suffix.length - 1, value.length - 1);\r\n    }\r\n\r\n    return value;\r\n  }\r\n\r\n  addingCompleterFromStart(value, completer) {\r\n    while (value.length < this.args.fractionDigits) {\r\n      value = `${completer}${value}`;\r\n    }\r\n    return value;\r\n  }\r\n\r\n  addingCompleterFromEnd(value, completer) {\r\n    while (value.length < this.args.fractionDigits) {\r\n      value = `${value}${completer}`;\r\n    }\r\n    return value;\r\n  }\r\n\r\n  removingCompleterFromStart(value, completer) {\r\n    while (value[0] === completer) {\r\n      value = value.replace(completer, '');\r\n    }\r\n    return value;\r\n  }\r\n\r\n  removingCompleterFromEnd(value, completer) {\r\n    while (value[value.length - 1] === completer) {\r\n      value = value.substring(0, value.length - 1);\r\n    }\r\n    return value;\r\n  }\r\n\r\n  addingAutoComplete(value) {\r\n    const n = `${value}${this.addingCompleterFromEnd('', '0')}`;\r\n    return n;\r\n  }\r\n\r\n  autoComplete(value) {\r\n    const regexp = new RegExp(`\\\\${this.args.decimalSeparator}`, 'g');\r\n    const array = value.match(regexp) || [];\r\n    if (array.length > 1) {\r\n      value = this.addingAutoComplete(value);\r\n    }\r\n    return value;\r\n  }\r\n\r\n  addingDecimalSeparator(value, completer, separator) {\r\n    let length = value.length - this.args.fractionDigits;\r\n\r\n    let regexpFraction;\r\n    let decimals = '$1';\r\n    let dezenas = completer;\r\n    let character = isFinite(completer) ? 'd' : 'w';\r\n\r\n    regexpFraction = `${this.isFloat(value) ? '.' : ''}(\\\\${character}{${this.args.fractionDigits}})`;\r\n\r\n    if (length > 0) {\r\n      regexpFraction = `(\\\\${character}{${length}})${regexpFraction}`;\r\n      dezenas = decimals;\r\n      decimals = '$2';\r\n    }\r\n    \r\n    console.log(value.replace(\r\n      new RegExp(regexpFraction),\r\n      `${dezenas}${separator}${decimals}`\r\n    ));\r\n\r\n    return value.replace(\r\n      new RegExp(regexpFraction),\r\n      `${dezenas}${separator}${decimals}`\r\n    );\r\n  }\r\n\r\n  addingHundredsSeparator(value) {\r\n    let size = value.length - this.args.fractionDigits;\r\n    let hundreds = Math.ceil(size / 3);\r\n    let regexpHundreds = this.isFloat(value) ? '.(\\\\d)' : '(\\\\d)';\r\n\r\n    let replacement = `${this.args.decimalSeparator}$${hundreds + 1}`;\r\n\r\n    for (let i = hundreds; i !== 0; i--) {\r\n      if (size >= 3) {\r\n        regexpHundreds = `(\\\\d{3})${regexpHundreds}`;\r\n        size -= 3;\r\n      } else {\r\n        regexpHundreds = `(\\\\d{${size}})${regexpHundreds}`;\r\n      }\r\n\r\n      if (i > 1) {\r\n        replacement = `${this.args.thousandsSeparator}$${i}${replacement}`;\r\n      } else {\r\n        replacement = `$${i}${replacement}`;\r\n      }\r\n    }\r\n\r\n    return value.replace(new RegExp(regexpHundreds), replacement);\r\n  }\r\n\r\n  removeSeparator(value, separator) {\r\n    return value.replace(new RegExp(`\\\\${separator}`, 'g'), '');\r\n  }\r\n\r\n  formatDecimal(value, completer, separator) {\r\n    value = this.addingCompleterFromStart(value, completer);\r\n    value = this.addingDecimalSeparator(value, completer, separator);\r\n    return value;\r\n  }\r\n\r\n  textToNumber(input) {\r\n    let retorno = input.toString();\r\n    let completer = this.completer();\r\n    \r\n    if (this.args.prefix) {\r\n      retorno = this.removingPrefix(retorno);\r\n    }\r\n    \r\n    if (this.args.suffix) {\r\n      retorno = this.removingSuffix(retorno);\r\n    }\r\n    \r\n    retorno = this.onlyNumber(retorno);\r\n\r\n    if (retorno.indexOf('.') === -1) {\r\n      retorno = this.removingCompleterFromStart(\r\n        retorno,\r\n        completer\r\n      );\r\n    }\r\n\r\n    return retorno || (this.args.fixed ? '0' : '');\r\n  }\r\n\r\n  numberToText(input) {\r\n    let retorno = this.emptyOrInvalid();\r\n\r\n    if (!isNaN(parseFloat(input))) {\r\n      if (input.length - 1 <= this.args.fractionDigits) {\r\n        retorno = this.formatDecimal(\r\n          input,\r\n          this.completer(),\r\n          this.args.decimalSeparator\r\n        );\r\n      } else {\r\n        retorno = this.addingHundredsSeparator(input);\r\n      }\r\n    }\r\n\r\n    if (this.args.prefix) {\r\n      retorno = this.addingPrefix(retorno);\r\n    }\r\n    if (this.args.suffix) {\r\n      retorno = this.addingSuffix(retorno);\r\n    }\r\n\r\n    return retorno;\r\n  }\r\n};\r\n","module.exports = {\r\n  getCaretPosition(input) {\r\n    let position = -1;\r\n    if ('selectionStart' in input) {\r\n      position = input.selectionStart;\r\n    } else if (document.selection) {\r\n      input.focus();\r\n      const range = document.selection.createRange();\r\n      const length = document.selection.createRange().text.length;\r\n      range.moveStart('character', -input.value.length);\r\n      position = range.text.length - length;\r\n    }\r\n    return position;\r\n  },\r\n\r\n  setCaretPosition(input, index) {\r\n    if (input.setSelectionRange) {\r\n      input.focus();\r\n      input.setSelectionRange(index, index);\r\n    } else if (input.createTextRange) {\r\n      const range = input.createTextRange();\r\n      range.collapse(true);\r\n      range.moveEnd('character', index);\r\n      range.moveStart('character', index);\r\n      range.select();\r\n    }\r\n  },\r\n\r\n  indexMove(newValue, oldValue) {\r\n    let move;\r\n    switch (true) {\r\n      case oldValue.length < newValue.length:\r\n        move = - 1;\r\n        break;\r\n      case oldValue.length > newValue.length:\r\n        move = 1;\r\n        break;\r\n      default:\r\n        move = 0;\r\n        break;\r\n    }\r\n    return move;\r\n  }\r\n};\r\n","const Args = require('./args');\r\nconst Core = require('./core');\r\nconst implanter = require('./implanter');\r\n\r\nlet _args = new Args();\r\nlet _core = new Core(_args);\r\n\r\nmodule.exports = class SimpleMaskMoney {\r\n  constructor() {\r\n    _args = new Args();\r\n    _core = new Core(_args);\r\n    Object.defineProperty(this, 'args', {\r\n      get() {\r\n        return _args;\r\n      },\r\n      set(value) {\r\n        _args = new Args(value);\r\n        _core = new Core(_args);\r\n      }\r\n    });\r\n    this.formatToNumber = SimpleMaskMoney.formatToNumber;\r\n    this.format = SimpleMaskMoney.format;\r\n    this.setMask = SimpleMaskMoney.setMask;\r\n  }\r\n\r\n  static get args() {\r\n    return _args;\r\n  }\r\n\r\n  static set args(value) {\r\n    _args = new Args(value);\r\n    _core = new Core(_args);\r\n  }\r\n\r\n  static format(value) {\r\n    const negative = _args.allowNegative && value.indexOf('-') !== -1;  \r\n    const formatation = _core.numberToText(_core.textToNumber(value));\r\n\r\n    return `${!_args.negativeSignAfter && negative ? '-': ''}${formatation}${_args.negativeSignAfter && negative ? '-': ''}`;\r\n  }\r\n\r\n  static formatToNumber(input) {\r\n    let retorno = '0';\r\n    let value = _core.textToNumber(input);\r\n    const negative = _args.allowNegative && input.indexOf('-') !== -1;   \r\n    \r\n    if (negative) {\r\n      value.replace('-', '');\r\n    }\r\n\r\n    if (!isNaN(parseFloat(value))) {\r\n      if (value.length <= _args.fractionDigits) {\r\n        value = _core.formatDecimal(value, '0', '.');\r\n      } else {\r\n        let lengthWithoutDecimals = value.length - _args.fractionDigits;\r\n        value = value.replace(\r\n          new RegExp(\r\n            `(\\\\d{${lengthWithoutDecimals}})(\\\\d{${_args.fractionDigits}})`\r\n          ),\r\n          '$1.$2'\r\n        );\r\n      }\r\n\r\n      retorno = value;\r\n    }\r\n      \r\n    return parseFloat(negative ? retorno * -1 : retorno);\r\n  }\r\n\r\n  static setMask(element, args) {\r\n    if (typeof document === 'undefined') throw 'This function only works on client side';\r\n\r\n    const input = typeof element == 'string' ? document.querySelector(element) : element;\r\n\r\n    if (args) {\r\n      SimpleMaskMoney.args = args;\r\n    }\r\n\r\n    input.addEventListener('input', e => {\r\n      const oldValue = input.value;\r\n      const newValue = SimpleMaskMoney.format(oldValue);\r\n      const caretPosition = implanter.getCaretPosition(input);\r\n      const move = implanter.indexMove(newValue, oldValue);\r\n      let newCaretPosition = caretPosition - move;\r\n      const {cursor} = SimpleMaskMoney.args;\r\n\r\n      if (cursor === 'start') {\r\n        newCaretPosition = 0;\r\n      } else if (cursor === 'end') {\r\n        newCaretPosition = newValue.length;\r\n      }\r\n\r\n      input.value = newValue;\r\n      input._value = newValue;\r\n\r\n      implanter.setCaretPosition(input, newCaretPosition);\r\n\r\n      !(e instanceof Event) && input.dispatchEvent(new Event('input'));\r\n    });\r\n\r\n    input['formatToNumber'] = () => SimpleMaskMoney.formatToNumber(input.value);\r\n\r\n    return input;\r\n  }\r\n};\r\n"],"names":["module","args","allowNegative","negativeSignAfter","decimalSeparator","fixed","fractionDigits","prefix","suffix","thousandsSeparator","cursor","merge","Args","number","size","padEnd","completer","value","hasDecimalSeparator","retorno","i","length","isFinite","replace","position","indexOf","substring","start","n","addingCompleterFromEnd","regexp","RegExp","array","match","addingAutoComplete","separator","regexpFraction","decimals","dezenas","character","isFloat","log","hundreds","Math","ceil","regexpHundreds","replacement","addingCompleterFromStart","addingDecimalSeparator","input","toString","removingPrefix","removingSuffix","onlyNumber","removingCompleterFromStart","emptyOrInvalid","isNaN","parseFloat","formatDecimal","addingHundredsSeparator","addingPrefix","addingSuffix","selectionStart","document","selection","focus","range","createRange","text","moveStart","index","setSelectionRange","createTextRange","collapse","moveEnd","select","newValue","oldValue","move","_args","_core","Core","defineProperty","formatToNumber","SimpleMaskMoney","format","setMask","negative","formatation","numberToText","textToNumber","lengthWithoutDecimals","element","querySelector","addEventListener","caretPosition","implanter","getCaretPosition","indexMove","newCaretPosition","_value","setCaretPosition","e","Event","dispatchEvent"],"mappings":"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"}